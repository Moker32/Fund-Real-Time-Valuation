# Fund Real-Time Valuation - GUI Version

åŸºé‡‘å®æ—¶ä¼°å€¼åº”ç”¨ GUI ç‰ˆæœ¬ï¼ŒåŸºäº Flet æ¡†æ¶å¼€å‘ï¼Œæä¾›å›¾å½¢åŒ–ç•Œé¢ã€‚

## ğŸ“¦ åŒ…ç®¡ç†æ–¹å¼

æœ¬é¡¹ç›®ä½¿ç”¨ **uv** ä½œä¸º Python åŒ…ç®¡ç†å™¨ã€‚

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.12+
- **åŒ…ç®¡ç†å™¨**: uv (`pip install uv`)
- **æ“ä½œç³»ç»Ÿ**: macOS / Linux / Windows

### å®‰è£…æ­¥éª¤

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/huangxiang/work/Fund-Real-Time-Valuation/.worktrees/gui-migration

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# 3. å®‰è£…ä¾èµ–
uv pip install -r requirements.txt

# 4. è¿è¡Œåº”ç”¨
uv run python run_gui.py --web
```

## ä¾èµ–è¯´æ˜

### æ ¸å¿ƒä¾èµ– (requirements.txt)

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| textual | â‰¥0.50.0 | TUI æ¡†æ¶ï¼ˆåŸç‰ˆï¼‰ |
| flet | â‰¥0.25.0 | **GUI æ¡†æ¶** |
| flet-desktop | 0.80.5 | **æ¡Œé¢æ‰“åŒ…** |
| httpx | â‰¥0.24.0 | HTTP å®¢æˆ·ç«¯ |
| akshare | â‰¥1.10.0 | è´¢ç»æ•°æ® API |
| yfinance | â‰¥0.2.0 | é›…è™é‡‘èæ•°æ® |
| pyyaml | â‰¥6.0 | YAML é…ç½® |
| beautifulsoup4 | â‰¥4.12.0 | ç½‘é¡µè§£æ |
| matplotlib | â‰¥3.7.0 | å›¾è¡¨ç»˜åˆ¶ |

### è¿è¡Œæ—¶ä¾èµ–

- **SQLite**: Python å†…ç½®ï¼Œæ— éœ€å•ç‹¬å®‰è£…
- **Chromium**: Flet æ¡Œé¢æ¨¡å¼é¦–æ¬¡è¿è¡Œè‡ªåŠ¨ä¸‹è½½ï¼ˆçº¦ 200MBï¼‰

### ä¾èµ–å®‰è£…ä½ç½®

```
.venv/lib/python3.12/site-packages/
â”œâ”€â”€ flet/                    # GUI æ¡†æ¶æ ¸å¿ƒ
â”œâ”€â”€ flet-desktop/            # æ¡Œé¢æ‰“åŒ…
â”œâ”€â”€ akshare/                 # è´¢ç»æ•°æ®
â”œâ”€â”€ httpx/                   # HTTP å®¢æˆ·ç«¯
â””â”€â”€ ...
```

## ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| FUND_TUI_CONFIG_DIR | é…ç½®ç›®å½• | ~/.fund-tui |

## å¿«é€Ÿå¼€å§‹

```bash
# Web æ¨¡å¼ï¼ˆæ— éœ€ä¸‹è½½ Chromiumï¼‰
cd /Users/huangxiang/work/Fund-Real-Time-Valuation/.worktrees/gui-migration
uv run python run_gui.py --web

# æ¡Œé¢æ¨¡å¼ï¼ˆé¦–æ¬¡éœ€ä¸‹è½½ Chromiumï¼‰
uv run python run_gui.py
```

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run pytest tests/ -v

# è¿è¡Œæ•°æ®åº“æµ‹è¯•
uv run pytest tests/test_database.py -v

# è¿è¡Œ GUI æµ‹è¯•
uv run pytest tests/test_gui.py -v
```

## é¡¹ç›®ç»“æ„

```
gui-migration/
â”œâ”€â”€ .venv/                    # è™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ run_gui.py               # GUI å…¥å£
â”œâ”€â”€ requirements.txt          # ä¾èµ–é…ç½®
â”œâ”€â”€ README.md                 # æœ¬æ–‡æ¡£
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ gui/
â”‚   â”‚   â””â”€â”€ main.py          # Flet åº”ç”¨
â”‚   â””â”€â”€ db/
â”‚       â””â”€â”€ database.py       # SQLite + DAO
â””â”€â”€ tests/
    â”œâ”€â”€ test_database.py      # æ•°æ®åº“æµ‹è¯•
    â””â”€â”€ test_gui.py          # GUI å›å½’æµ‹è¯•
```

## ä¸ä¸»åˆ†æ”¯çš„å…³ç³»

- **ä¸»åˆ†æ”¯ (main)**: TUI ç‰ˆæœ¬ï¼Œä½¿ç”¨ Textual
- **gui-migration**: GUI ç‰ˆæœ¬ï¼Œä½¿ç”¨ Flet + SQLite

åŠŸèƒ½å®Œå…¨ç§»æ¤ï¼Œæ•°æ®æºä¿æŒä¸€è‡´ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š åŸºé‡‘ç›‘æ§
- å®æ—¶è·å–åŸºé‡‘ä¼°å€¼æ•°æ®
- è‡ªé€‰åŸºé‡‘æ·»åŠ /åˆ é™¤/ç®¡ç†
- æŒä»“è®¾ç½®ï¼ˆä»½é¢ã€æˆæœ¬ä»·ï¼‰
- æŒä»“ç›ˆäºè‡ªåŠ¨è®¡ç®—
- å‡€å€¼æ¶¨è·Œå¹…å±•ç¤º

### ğŸ“ˆ å•†å“è¡Œæƒ…
- å¤§å®—å•†å“å®æ—¶è¡Œæƒ…
- æ”¯æŒå¤šç§å•†å“ï¼ˆé»„é‡‘ã€ç™½é“¶ã€åŸæ²¹ç­‰ï¼‰
- æ¶¨è·Œå¹…å¿«é€Ÿé¢„è§ˆ

### ğŸ“° è´¢ç»æ–°é—»
- è´¢ç»æ–°é—»å®æ—¶è·å–
- æ–°é—»æ¥æºå±•ç¤º
- ä¸€é”®æ‰“å¼€åŸæ–‡é“¾æ¥

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–
- SQLite å°å‹æ•°æ®åº“
- åŸºé‡‘é…ç½®æŒä¹…åŒ–
- å•†å“é…ç½®æŒä¹…åŒ–
- å†å²å‡€å€¼å­˜å‚¨
- é…ç½®è·¨ä¼šè¯ä¿å­˜

## æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| GUI æ¡†æ¶ | Flet (Flutter for Python) |
| æ•°æ®åº“ | SQLite (Python å†…ç½®) |
| æ•°æ®æº | akshare, yfinance, httpx |
| åŒ…ç®¡ç† | uv + venv |

## å®‰è£…æ­¥éª¤

### 1. å…‹éš†å¹¶è¿›å…¥ç›®å½•

```bash
cd /Users/huangxiang/work/Fund-Real-Time-Valuation/.worktrees/gui-migration
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```bash
uv venv
uv pip install -r requirements.txt
```

### 3. è¿è¡Œåº”ç”¨

```bash
# æ–¹å¼ä¸€ï¼šç›´æ¥è¿è¡Œ
uv run python run_gui.py

# æ–¹å¼äºŒï¼šæ¿€æ´»ç¯å¢ƒåè¿è¡Œ
source .venv/bin/activate
python run_gui.py
```

## ä½¿ç”¨è¯´æ˜

### ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸºé‡‘å®æ—¶ä¼°å€¼                              [åˆ·æ–°] [è®¾ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [åŸºé‡‘]  [å•†å“]  [æ–°é—»]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»£ç     åç§°      å•ä½å‡€å€¼  ä¼°ç®—å‡€å€¼  æ¶¨è·Œå¹…  æŒä»“ç›ˆäº  â”‚
â”‚  161039 å¯Œå›½æ–°èƒ½... 1.2345   1.2456   +1.23%  +156.78   â”‚
â”‚  161725 æ‹›å•†ç™½é…’... 1.0234   1.0356   -0.45%  -89.32    â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­‰å¾…æ›´æ–°...                                     æ•°æ®æº: â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¿«æ·æ“ä½œ

| æ“ä½œ | è¯´æ˜ |
|------|------|
| ç‚¹å‡»"æ·»åŠ åŸºé‡‘" | æ·»åŠ æ–°çš„è‡ªé€‰åŸºé‡‘ |
| ç‚¹å‡»"æŒä»“è®¾ç½®" | è®¾ç½®æŒä»“ä»½é¢å’Œæˆæœ¬ä»· |
| ç‚¹å‡»"æŸ¥çœ‹å›¾è¡¨" | æŸ¥çœ‹å‡€å€¼èµ°åŠ¿å›¾ |
| ç‚¹å‡»"åˆ é™¤" | ä»è‡ªé€‰ç§»é™¤åŸºé‡‘ |
| ç‚¹å‡»åˆ·æ–°æŒ‰é’® | æ‰‹åŠ¨åˆ·æ–°æ•°æ® |

## æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
uv run pytest tests/ -v
```

### æµ‹è¯•è¦†ç›–

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | è¯´æ˜ |
|---------|---------|------|
| tests/test_database.py | 28 | æ•°æ®åº“ DAO æµ‹è¯• |
| tests/test_gui.py | 21 | GUI æ¨¡å—æµ‹è¯• |

### æµ‹è¯•ç»“æœ

```
======================== 49 passed in 0.62s ========================
```

## é¡¹ç›®ç»“æ„

```
gui-migration/
â”œâ”€â”€ run_gui.py              # GUI å…¥å£æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # ä¾èµ–é…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ __init__.py     # æ•°æ®åº“æ¨¡å—å¯¼å‡º
â”‚   â”‚   â””â”€â”€ database.py      # SQLite + DAO å®ç°
â”‚   â””â”€â”€ gui/
â”‚       â”œâ”€â”€ __init__.py      # GUI æ¨¡å—å¯¼å‡º
â”‚       â””â”€â”€ main.py          # Flet ä¸»åº”ç”¨
â””â”€â”€ tests/
    â”œâ”€â”€ test_database.py     # æ•°æ®åº“æµ‹è¯•
    â””â”€â”€ test_gui.py         # GUI å›å½’æµ‹è¯•
```

## æ•°æ®åº“ç»“æ„

### fund_config è¡¨
```sql
CREATE TABLE fund_config (
    code TEXT PRIMARY KEY,      -- åŸºé‡‘ä»£ç 
    name TEXT NOT NULL,         -- åŸºé‡‘åç§°
    watchlist INTEGER DEFAULT 1, -- æ˜¯å¦åœ¨è‡ªé€‰
    shares REAL DEFAULT 0,      -- æŒæœ‰ä»½é¢
    cost REAL DEFAULT 0,        -- æˆæœ¬ä»·
    notes TEXT DEFAULT '',       -- å¤‡æ³¨
    created_at TEXT,             -- åˆ›å»ºæ—¶é—´
    updated_at TEXT              -- æ›´æ–°æ—¶é—´
);
```

### commodity_config è¡¨
```sql
CREATE TABLE commodity_config (
    symbol TEXT PRIMARY KEY,     -- å•†å“ä»£ç 
    name TEXT NOT NULL,          -- å•†å“åç§°
    source TEXT DEFAULT 'akshare', -- æ•°æ®æº
    enabled INTEGER DEFAULT 1,   -- æ˜¯å¦å¯ç”¨
    notes TEXT DEFAULT '',       -- å¤‡æ³¨
    created_at TEXT,            -- åˆ›å»ºæ—¶é—´
    updated_at TEXT             -- æ›´æ–°æ—¶é—´
);
```

### fund_history è¡¨
```sql
CREATE TABLE fund_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    fund_code TEXT NOT NULL,     -- åŸºé‡‘ä»£ç 
    fund_name TEXT,             -- åŸºé‡‘åç§°
    date TEXT NOT NULL,         -- æ—¥æœŸ
    unit_net_value REAL,        -- å•ä½å‡€å€¼
    accumulated_net_value REAL,  -- ç´¯è®¡å‡€å€¼
    estimated_value REAL,        -- ä¼°ç®—å‡€å€¼
    growth_rate REAL,           -- å¢é•¿ç‡
    fetched_at TEXT             -- æŠ“å–æ—¶é—´
);
```

## ä» TUI è¿ç§»

åŸæœ‰çš„ TUI ç‰ˆæœ¬ä½äºä¸»åˆ†æ”¯ï¼Œä½¿ç”¨ Textual æ¡†æ¶ã€‚GUI ç‰ˆæœ¬æä¾›äº†ï¼š

1. **å›¾å½¢åŒ–ç•Œé¢** - æ›´ç›´è§‚çš„æ“ä½œæ–¹å¼
2. **é¼ æ ‡äº¤äº’** - æ”¯æŒç‚¹å‡»ã€æ‹–æ‹½ç­‰æ“ä½œ
3. **æ•°æ®æŒä¹…åŒ–** - SQLite æ›¿ä»£ YAML é…ç½®æ–‡ä»¶
4. **ç°ä»£åŒ–å¤–è§‚** - æ·±è‰²ä¸»é¢˜ã€å¡ç‰‡å¼å¸ƒå±€

## æ³¨æ„äº‹é¡¹

- Flet åº”ç”¨é¦–æ¬¡å¯åŠ¨å¯èƒ½éœ€è¦ä¸‹è½½ Chromium æµè§ˆå™¨
- ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸ä»¥è·å–å®æ—¶æ•°æ®
- æ•°æ®æºå¯èƒ½å­˜åœ¨è®¿é—®é¢‘ç‡é™åˆ¶

## è®¸å¯è¯

MIT License
